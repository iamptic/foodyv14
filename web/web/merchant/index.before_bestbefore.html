<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Foody ¬∑ –õ–ö —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞</title>
  <link rel="stylesheet" href="./style.css?v=dark2" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
<!-- FilePond CSS -->
<link href="https://unpkg.com/filepond@4.30.7/dist/filepond.min.css" rel="stylesheet">
<link href="https://unpkg.com/filepond-plugin-image-preview@4.6.12/dist/filepond-plugin-image-preview.min.css" rel="stylesheet">
<link href="./offer_photo_filepond.css" rel="stylesheet">
  <script defer src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>
  <script>window.foodyApi = (window.__FOODY__ && window.__FOODY__.FOODY_API) || window.foodyApi || 'https://foodyback-production.up.railway.app';</script>
  <script defer src="/config.js"></script>
  <script defer src="./app.js?v=no247-1"></script>
  <style>
    #cityModal[aria-hidden="true"] { display: none; }
    #cityModal[aria-hidden="false"] { display: block; }
    #cityModal { position: fixed; inset: 0; z-index: 50; }
    #cityModal .modal-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,.5); backdrop-filter: blur(2px); }
    #cityModal .modal-dialog { position: relative; max-width: 520px; margin: 6vh auto; background: var(--card-bg, #121212); color: var(--fg, #fff); border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,.4); overflow: hidden; }
    #cityModal .modal-header { display:flex; align-items:center; justify-content:space-between; padding:16px 18px; font-weight:600; border-bottom: 1px solid rgba(255,255,255,.08); }
    #cityModal .modal-body { padding: 14px 16px 16px; }
    #cityModal .close { background: transparent; border:none; font-size:20px; line-height:1; color: inherit; cursor: pointer; opacity:.8; }
    #cityModal .close:hover { opacity:1; }

    .city-search { width: 100%; padding: 10px 12px; border-radius: 10px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); color: inherit; outline: none; }
    .city-search::placeholder { opacity:.6; }

    .city-grid { margin-top: 12px; display: grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 8px; }
    @media (min-width: 480px) { .city-grid { grid-template-columns: repeat(3, minmax(0,1fr)); } }
    .city-chip { padding: 10px 12px; border-radius: 12px; text-align:center; cursor:pointer; user-select:none;
      border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); transition: transform .06s ease, background .2s ease, border-color .2s ease; }
    .city-chip:hover { transform: translateY(-1px); background: rgba(255,255,255,.07); border-color: rgba(255,255,255,.2); }
    .city-chip.active { background: rgba(0, 180, 120, .2); border-color: rgba(0, 180, 120, .4); }

    .city-other { margin-top: 12px; display:flex; gap:8px; align-items:center; }
    .city-other input { flex:1; padding: 10px 12px; border-radius: 10px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); color: inherit; }
    .city-other .btn { white-space:nowrap; }

    .city-picker { display:flex; gap:8px; align-items:center; }
    .city-display { flex:1; display:flex; align-items:center; justify-content:space-between; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); cursor:pointer; }
    .city-display .hint { opacity:.7; }
    .city-display .value { font-weight:600; }
    .city-display .caret { opacity:.6; }

    .btn { border-radius: 12px; padding: 10px 12px; border: none; cursor: pointer; }
    .btn-primary { background: #00C27A; color:#081A12; font-weight:700; }
    .btn-ghost { background: transparent; color: inherit; border:1px solid rgba(255,255,255,.12); }

    .w-full { width:100%; }

    .pw-field { position: relative; display: flex; align-items: center; }
    .pw-field input[type="password"], .pw-field input[type="text"] { width:100%; padding-right: 42px; }
    .pw-toggle { position: absolute; right: 8px; background: transparent; border: 0; cursor: pointer; font-size: 18px; line-height: 1; opacity: .75; }
    .pw-toggle:hover { opacity: 1; }
    .pw-toggle[aria-pressed="true"] { opacity: 1; }

    .work-presets { grid-column: 1 / -1; display: flex; flex-wrap: wrap; gap: 8px; margin-top: 6px; }
    .work-presets .chip { padding: 8px 10px; border-radius: 12px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); cursor:pointer; user-select:none; }
    .work-presets .chip:hover { background: rgba(255,255,255,.08); }

    .form-error { color: #ff7b7b; font-size: 13px; }
    .hidden { display: none; }
    .muted.small { opacity:.7; font-size:12px; }
    .ok-badge { color:#00C27A; font-weight:600; font-size: 13px; }
  </style>
</head>
<body>
  <div class="app">
    <header class="tg-header">
      <div class="tg-header__left">
        <div class="avatar">üçΩÔ∏è</div>
        <div class="titles">
          <div class="title">Foody</div>
          <div class="subtitle">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞</div>
        </div>
      </div>
      <div class="tg-header__right">
        <button id="logoutBtn" class="btn btn-ghost" style="display:none">–í—ã–π—Ç–∏</button>
      </div>
    </header>

    <nav class="segmented" id="tabs">
      <button class="seg-btn active" data-tab="dashboard">–î–∞—à–±–æ—Ä–¥</button>
      <button class="seg-btn" data-tab="offers">–û—Ñ—Ñ–µ—Ä—ã</button>
      <button class="seg-btn" data-tab="create">–°–æ–∑–¥–∞—Ç—å</button>
      <button class="seg-btn" data-tab="profile">–ü—Ä–æ—Ñ–∏–ª—å</button>
      <button class="seg-btn" data-tab="export">–≠–∫—Å–ø–æ—Ä—Ç</button>
    </nav>

    <main class="content">
      <section class="pane active" id="dashboard">
        <div class="card">
          <div class="card-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</div>
          <p class="muted">–í–æ–π–¥–∏—Ç–µ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ñ—Ñ–µ—Ä—ã –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ—Ñ–∏–ª–µ–º.</p>
        </div>
      </section>

     <section class="pane" id="create">
  <div class="card">
    <div class="card-title">–°–æ–∑–¥–∞—Ç—å –æ—Ñ—Ñ–µ—Ä</div>
    <form id="offerForm" class="form grid two">

      <!-- 1) –ù–∞–∑–≤–∞–Ω–∏–µ -->
      <label class="full">–ù–∞–∑–≤–∞–Ω–∏–µ
        <input name="title" placeholder="–ù–∞–ø—Ä., –ù–∞–±–æ—Ä —Å—É—à–∏ ¬´–ó–∞–∫–∞—Ç¬ª" required>
      </label>

      <!-- 2) –¶–µ–Ω–∞ (—Å—Ç–∞—Ä–∞—è / –æ–±—ã—á–Ω–∞—è) -->
      <label>–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞ (–¥–æ —Å–∫–∏–¥–∫–∏)
        <input name="original_price" id="offerOldPrice" type="number" min="0" step="1" placeholder="–ù–∞–ø—Ä., 350" required>
      </label>

      <!-- 3) –°–∫–∏–¥–∫–∞ (—á–∏–ø—Å—ã) -->
      <div class="full">
        <div class="work-presets" id="discountPresets">
          <span class="chip" data-discount="30">-30%</span>
          <span class="chip" data-discount="40">-40%</span>
          <span class="chip" data-discount="50">-50%</span>
          <span class="chip" data-discount="60">-60%</span>
          <span class="chip" data-discount="70">-70%</span>
          <span class="chip" data-discount="80">-80%</span>
          <span class="chip" data-discount="90">-90%</span>
        </div>
      </div>

      <!-- 4) –ù–æ–≤–∞—è —Ü–µ–Ω–∞ (–ø–æ—Å–ª–µ —Å–∫–∏–¥–∫–∏) -->
      <label>–ù–æ–≤–∞—è —Ü–µ–Ω–∞
        <input name="price" id="offerPrice" type="number" min="0" step="1" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, 190" required>
      </label>

      <!-- 5) –û—Å—Ç–∞—Ç–æ–∫ / –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ -->
      <label>–û—Å—Ç–∞—Ç–æ–∫ / –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, —à—Ç
        <input name="qty_total" type="number" min="1" step="1" value="1" required>
      </label>

      <!-- –°—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ (–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–µ –ø–æ–ª–µ) -->
      <label class="full">–°—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∞
        <input id="bestBefore" type="datetime-local" placeholder="–¥–æ –∫–∞–∫–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–¥—É–∫—Ç –æ–∫">
        <div class="muted small">–ü–æ–ª–µ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è ‚Äî –≤ API –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è.</div>
      </label>

      <!-- –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –æ—Ñ—Ñ–µ—Ä–∞ -->
      <label class="full">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –æ—Ñ—Ñ–µ—Ä–∞
        <input name="expires_at" id="expires_at" placeholder="–°–µ–≥–æ–¥–Ω—è 21:00" required>
      </label>
      <div class="full">
        <div class="work-presets" id="expirePresets">
          <span class="chip" data-action="close" id="expireToClose" style="display:none">–ö –∑–∞–∫—Ä—ã—Ç–∏—é</span>
        </div>
      </div>

      <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è -->
      <label class="full">–ö–∞—Ç–µ–≥–æ—Ä–∏—è
        <select name="category">
          <option value="ready_meal">–ì–æ—Ç–æ–≤—ã–µ –±–ª—é–¥–∞</option>
          <option value="bakery">–í—ã–ø–µ—á–∫–∞</option>
          <option value="sushi">–°—É—à–∏/—Ä–æ–ª–ª—ã</option>
          <option value="salad">–°–∞–ª–∞—Ç—ã</option>
          <option value="dessert">–î–µ—Å–µ—Ä—Ç—ã</option>
          <option value="other">–î—Ä—É–≥–æ–µ</option>
        </select>
      </label>

      <!-- –§–æ—Ç–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
      <div class="field">
        <label for="offerImage">–§–æ—Ç–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
        <input type="file" id="offerImage" name="offerImage" accept="image/*">
        <input type="hidden" id="offerImageUrl" name="image_url">
        <p class="hint">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è JPG/PNG/WebP –¥–æ 5 –ú–ë</p>
      </div>

      <!-- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ -->
      <label class="full">
        <textarea name="description" rows="3" placeholder="–ö—Ä–∞—Ç–∫–æ: —Å–æ—Å—Ç–∞–≤, –ø–æ—Ä—Ü–∏–∏ –∏ —Ç.–ø."></textarea>
      </label>

      <div class="full" style="display:flex;gap:8px;align-items:center;justify-content:flex-end;">
        <div id="offerError" class="form-error hidden" style="margin-right:auto"></div>
        <button class="btn btn-primary" type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ñ—Ñ–µ—Ä</button>
      </div>
    </form>
  </div>
</section>


      <section class="pane" id="offers">
        <div class="card">
          <div class="card-title">–ú–æ–∏ –æ—Ñ—Ñ–µ—Ä—ã</div>
          <div id="offerList" class="table">
            <div class="skeleton"></div>
            <div class="skeleton"></div>
          </div>
        </div>
      </section>

      

      <section class="pane" id="profile">
        <div class="card">
          <div class="card-title">–ü—Ä–æ—Ñ–∏–ª—å —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞</div>
          <form id="profileForm" class="form grid two">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ
              <input name="name" placeholder="–ö–∞—Ñ–µ –ü–ª—é—Å">
            </label>
            <label>–¢–µ–ª–µ—Ñ–æ–Ω
              <input name="phone" id="profilePhone" type="tel" inputmode="tel" autocomplete="tel" placeholder="+7 900 000 00 00">
            </label>
            <label class="full">–ì–æ—Ä–æ–¥
              <div class="city-picker">
                <div id="profileCityOpen" class="city-display w-full">
                  <span class="hint">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</span>
                  <span class="value"></span>
                  <span class="caret">‚ñæ</span>
                </div>
                <input type="hidden" name="city" id="profileCityValue">
              </div>
            </label>
            <label class="full">–ê–¥—Ä–µ—Å
              <input name="address" placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º">
            </label>
            <label>–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã ‚Äî —Å
              <input name="work_from" id="profile_work_from" type="time" placeholder="09:00">
            </label>
            <label>–¥–æ
              <input name="work_to" id="profile_work_to" type="time" placeholder="22:00">
            </label>
            <div class="muted small full">–ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–æ—á–Ω—ã–µ —Å–º–µ–Ω—ã ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, <b>20:00‚Äì04:00</b>.</div>
            <div class="work-presets" data-for="profile">
              <span class="chip" data-from="10:00" data-to="22:00">10:00‚Äì22:00</span>
              <span class="chip" data-from="09:00" data-to="21:00">09:00‚Äì21:00</span>
              <span class="chip" data-from="00:00" data-to="23:59">24/7</span>
            </div>
            <div class="full" style="display:flex;gap:8px;align-items:center;justify-content:flex-end;">
              <div id="profileError" class="form-error hidden" style="margin-right:auto"></div>
              <span id="profileSaved" class="ok-badge" style="display:none;margin-right:auto;">–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ‚úì</span>
              <button class="btn btn-primary" type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
          </form>
        </div>

        <div class="card">
          <div class="card-title">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</div>
          <form id="pwForm" class="form">
            <label>–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å
              <div class="pw-field">
                <input type="password" id="pwOld" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                <button class="pw-toggle" id="pwOldToggle" type="button" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å" aria-pressed="false">üëÅ</button>
              </div>
            </label>
            <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å
              <div class="pw-field">
                <input type="password" id="pwNew" placeholder="–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤" minlength="6" required>
                <button class="pw-toggle" id="pwNewToggle" type="button" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å –ø–∞—Ä–æ–ª—å" aria-pressed="false">üëÅ</button>
              </div>
            </label>
            <label>–ü–æ–≤—Ç–æ—Ä –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è
              <input type="password" id="pwNew2" placeholder="–ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" minlength="6" required>
            </label>
            <div id="pwError" class="form-error hidden"></div>
            <div style="display:flex;gap:8px;align-items:center;justify-content:flex-end;">
              <span id="pwSaved" class="ok-badge" style="display:none;margin-right:auto;">–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ ‚úì</span>
              <button class="btn btn-primary" type="submit">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
            </div>
          </form>
        </div>
      </section>

      <section class="pane" id="export">
        <div class="card">
          <div class="card-title">–≠–∫—Å–ø–æ—Ä—Ç CSV</div>
          <p class="muted">–°–∫–∞—á–∞–π—Ç–µ –≤—ã–≥—Ä—É–∑–∫—É —Ç–µ–∫—É—â–∏—Ö –æ—Ñ—Ñ–µ—Ä–æ–≤.</p>
          <button id="downloadCsv" class="btn btn-primary">–°–∫–∞—á–∞—Ç—å CSV</button>
        </div>
        <div class="card">
          <div class="card-title">–¢–µ–∫—É—â–∏–µ –∫–ª—é—á–∏</div>
          <pre id="creds" class="dump small">‚Äî</pre>
          <div class="muted small">–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å API.</div>
        </div>
      </section>
    </main>

    <nav class="bottom-nav">
      <button class="nav-btn active" data-tab="dashboard" title="–î–∞—à–±–æ—Ä–¥">üè†</button>
      <button class="nav-btn" data-tab="offers" title="–û—Ñ—Ñ–µ—Ä—ã">üõçÔ∏è</button>
      <button class="nav-btn fab" data-tab="create" title="–°–æ–∑–¥–∞—Ç—å">Ôºã</button>
      <button class="nav-btn" data-tab="profile" title="–ü—Ä–æ—Ñ–∏–ª—å">üë§</button>
      <button class="nav-btn" data-tab="export" title="–≠–∫—Å–ø–æ—Ä—Ç">‚¨áÔ∏è</button>
    </nav>

    <div class="modal" id="cityModal" aria-hidden="true">
      <div class="modal-backdrop" id="cityBackdrop"></div>
      <div class="modal-dialog" role="dialog" aria-modal="true">
        <div class="modal-header">
          –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥
          <button class="close" id="cityClose" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
        <div class="modal-body">
          <input type="text" id="citySearch" class="city-search" placeholder="–ü–æ–∏—Å–∫ –≥–æ—Ä–æ–¥–∞‚Ä¶">
          <div class="city-grid" id="cityGrid"></div>
          <div class="city-other" id="cityOtherWrap" style="display:none;">
            <input id="cityOtherInput" placeholder="–°–≤–æ–π –≥–æ—Ä–æ–¥">
            <button id="cityOtherApply" class="btn btn-primary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
          </div>
        </div>
      </div>
    </div>

    <div id="toast"></div>
  </div>

  <!-- FilePond JS -->
<script src="https://unpkg.com/filepond@4.30.7/dist/filepond.min.js" defer></script>
<script src="https://unpkg.com/filepond-plugin-image-preview@4.6.12/dist/filepond-plugin-image-preview.min.js" defer></script>
<script src="https://unpkg.com/filepond-plugin-file-validate-type@1.2.8/dist/filepond-plugin-file-validate-type.min.js" defer></script>
<script src="https://unpkg.com/filepond-plugin-file-validate-size@2.2.8/dist/filepond-plugin-file-validate-size.min.js" defer></script>

<!-- –ù–∞—à –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ç–æ—Ä -->
</body>
</html>
